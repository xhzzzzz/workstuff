x_cols = [c for c in df.columns if c.endswith('_x')]

for col in df.filter(regex='_x$'):
    base = col[:-2]
    df[base] = np.divide(
        df[base + '_y'],
        df[col],
        out=np.zeros_like(df[col], dtype=float),
        where=df[col] != 0
    )
